{% extends 'admin/base.html.twig' %}

{% block title %}Companies{% endblock %}

{% block body %}
<h2>Companies Management</h2>

<form method="get" style="margin: 1rem 0; display: flex; gap: 1rem;">
    <select name="status">
        <option value="">All</option>
        <option value="approved" {{ status == 'approved' ? 'selected' : '' }}>Approved</option>
        <option value="pending" {{ status == 'pending' ? 'selected' : '' }}>Pending</option>
        <option value="active" {{ status == 'active' ? 'selected' : '' }}>Active</option>
        <option value="inactive" {{ status == 'inactive' ? 'selected' : '' }}>Inactive</option>
    </select>
    <button type="submit" class="btn btn-primary">Filter</button>
</form>

<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Owner</th>
            <th>Approved</th>
            <th>Active</th>
            <th>Job Offers</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for company in companies %}
        <tr>
            <td>{{ company.id }}</td>
            <td>{{ company.name }}</td>
            <td>{{ company.user.email }}</td>
            <td>{{ company.isApproved ? 'Yes' : 'No' }}</td>
            <td>{{ company.isActive ? 'Yes' : 'No' }}</td>
            <td>{{ company.jobOffers|length }}</td>
            <td>
                <a href="{{ path('admin_company_show', {id: company.id}) }}" class="btn btn-primary">View</a>
                <a href="{{ path('admin_company_edit', {id: company.id}) }}" class="btn btn-warning">Edit</a>
                <form method="post" action="{{ path('admin_company_delete', {id: company.id}) }}" style="display: inline;" onsubmit="return confirm('Are you sure?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('admin_company_delete') }}">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="7">No companies found</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

